---
title: iOS端末にのみ発生した豆腐（文字化け文字）とそれの対処
tags:
  - Tohu
date: 2019-07-09 9:00:0
category: Web Frontend
---

sKawashimaです。
当ブログの一部の記事において、**iOS端末で表示した場合にのみ文章内に豆腐（文字化け文字）が発生するバグ**を発見し、**2019年7月7日に修正**しました。
いつも当ブログを読んでいただいている方にはありがとうございます、そして今までご迷惑をおかけしました。

ただ、この文字化けはいわゆる**文字コード指定によるものではありません**。

その**豆腐の発生条件が少々特殊**であり、未だ完全な解決に至っていないためこうして記事を執筆します。
もし何か分かりましたら、[こちら](https://github.com/sKawashima/blog/issues/68)まで情報をいただけるとありがたいです。
それでは始めます。

<!-- more -->

---

## 目次

<!-- toc -->

## iOSにのみ発生した豆腐の再現

ひとまず、豆腐を再現します。
iOS環境**でのみ**、↓に豆腐が発生しているはずです。
このブログサイトは`hexo`という**静的サイトジェネレータ**で生成されています。
公開自体はとてもシンプルで、`html`と`css`と`js`を書き出してサーバーにアップロードするというものです。
PCで確認していただくと分かりますが、この豆腐の部分には文字や疑似要素が入っているわけではないので、単純な文字化けとは話が違うのです。

## 発生条件の整理

この豆腐は**iOS端末**でしか再現されません（ここは豆腐がない）。
しかし、**strong**や`code`などのインライン要素に当たるタグを使っており、**その中身の両端が半角文字**かつ**隣接する文字が半角文字でない**場合にこのバグは発生します。

**中身の両端が全角文字**であれば**隣接する文字が半角文字でない**場合でも豆腐は発生しません。
**中身の両端が半角文字**でも**隣接する文字が半角文字**であれば豆腐は発生しません：abc**dいーf**ghi

* また、**list**内ではこれらの条件に関わらず豆腐は発生しません。

## 原因の推測

まず、MacOS,Android,iOSの3環境で検証してこの事例を確認できたのがiOS端末のみであったため、これは**iOSのOS単位のバグ**と考えています。
ただし、他のサイトではあまり発生していないように見えますね。
これについては、文字の揃え方に関する `CSS` の記述が影響していると考えています。

当ブログでは、本文に対して `text-align: justify;` 、つまりCSSによる両端揃えを適用しています。
他のそのようなサイトを確認したわけじゃないのでなんともですが、ひとまずそこが原因だと睨んでいます。

## 現在このブログで行った対処

ひとまず、↑の法則がわかったので半角英数を使用する際は記事に半角空白を入れるという対処を取りました。
現状は対症療法であり、原因もわからない状態なので、詳しいことがわかる方は情報をいただけるとありがたいです。

これからも当ブログをよろしくおねがいします。それでは。
